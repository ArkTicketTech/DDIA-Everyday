#### 1. Network Fault in Practice
网络故障问题非常普遍：
1. 一 家中型数据中心完成的调查发现， 每月大约有 12 次网络故障， 其中有一半涉及单台机器， 有一半甚至是整个机架断网。
2. 研究分析了机架式交换机，汇聚层交换机和负载均衡器等组件的故障率，结果发现增加冗余网络设备并不会像期望的那样可以显著减少故障， 主要是因为无法有效防范入为错误（例如配置错误）

网络分区：当网络的一部分由千网络故障而与其他部分断开， 称之为网络分区或网络分割。

只要有网络通信，就无法避免故障。处理网络故障并不意味着需要复杂的容错措施，例如说，对用户提示错误信息，前提是如何规定好软件该如何面对错误，并确保恢复。

#### 2. Detecting Fault
分布式系统需要自动检测节点失效的功能：
* 负载均衡器需要将出问题节点进行下线，避免向已失效的节点继续发送请求。
* 主从复制的分布式数据库，主节点失败后，需要将某个节点提升为主节点，但网络的不确定性，很难判断主节点是否失效。
* 如果可以登陆节点，但发现服务进程没有监听目标端口（例如，进程崩溃），那么操作系统回返回 RST 和 FIN 标志的数据包来辅助关闭或拒绝 TCP 连接。但如果在节点处理请求的过程中发生了崩溃，则很难知道该节点实际处理了多少数据。
* 如果服务进程崩溃，但操作系统仍然运行，可以通过脚本通知其它节点，让新节点来接管该节点。（HBase 方式）
* 如果有权访问数据中心网络交换机， 则可以通过管理接口查询是否存在硬件级别的链路故障（例如远程节点掉电）。（存在局限性，接口可能由于网络原因不可用）
* 如果路由器已经确认目标节点不可访问， 则会返回 ICMP "目标不可达“ 数据包来回复请求。

自动检测节点失效不是万能的。某些情况下需要应用级别的回复。

如果出现了问题，需要重试（包括 TCP 重试和应用级别的重试），等待超时后，才能最终声明节点已经失效。