分区与二级索引

-   基于文档分区的二级索引
    -   分区独立，各自维护二级索引
    -   本地索引，不是全局索引
    -   需要并行查询并合并结果，容易导致读延迟放大
-   基于词条分区的二级索引
    -   对所有数据构建全局索引
    -   全局索引进行分区
    -   优点
        -   读取高效（只查询包含的分区）
    -   缺点
        -   写入慢且繁琐
        -   写放大
    -   异步更新全局二级索引



分区再平衡

-   为什么不取模
    -   节点数N变化了，会导致很多关键字需要迁移
-   固定数量的分区
    -   分区数远超实际节点数，每个节点分配多个分区
    -   添加新节点，从旧节点上匀走分区
    -   需要调整分区与节点的对应关系
    -   不支持分区拆分功能



Pp. 195-200