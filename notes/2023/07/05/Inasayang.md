序列号排序

-   使用序列号或时间戳来排序事件
    -   时间戳不一定是墙上时钟，因为存在很多问题
    -   只能是逻辑时钟，使用算法生成一个数字序列用来识别，通常是递增的计数器
-   只有几字节，总是通过比较确定大小



非因果序列发生器

-   系统不存在唯一的主节点（多主或无主）
-   每个节点单独产生自己的一组序列号
    -   如，两个节点，一个生成奇数，一个生成偶数
    -   或者，序列号保留表示节点的唯一标识符
-   把墙上时钟附加到操作上（？不是说墙上时钟有很多问题吗）
-   预先分配序列号的区间范围
    -   A负责1-1000
    -   B负责1001-2000



`Lamport`时间戳

-   产生与因果关系一致的序列号，兰伯特时间戳

-   每个节点有唯一标识符且有一个计数器记录各自已处理的请求总数

-   `Lamport`时间戳是一个值对（计数器，节点ID）

-   `Lamport`时间戳与墙上时钟没有直接对应关系

-   两个`Lamport`时间戳，计数器大的时间戳大；如果计数器相等，则节点ID越大，时间戳越大

-   每个节点和每个客户端跟踪遇到过的最大计数器值，并在每个请求中附带此值。节点收到时，如果请求中的最大计数器大于自己的，则修改为该值

-   版本向量用来区分两个操作是并发还是因果依赖；`Lamport`时间戳用来确保全序关系，无法区分两个操作是否属于并发关系还是因果依赖关系

    

Pp. 323-327