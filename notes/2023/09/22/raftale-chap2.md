#### 网状模型

层次模型的树结构中，每条记录只有一个父节点；在网络模式中，每条记录可能有多个父节点。



#### 关系模型

一个关系（表）只是一个元组（行）的集合。



#### 与文档数据库相比

在表示一对多和多对多的关系时，关系数据库和文档数据库没有根本的区别，相关项目都被一个唯一的标识符饮用，这个标识符在关系模型中被称为一个外键，在文档模型中被称为文档引用。



#### 关系数据库和文档数据库在今日的对比

应用程序想要改变数据格式的情况下，文档模型可以直接加，但关系数据库需要先迁移操作，也就是DDL，DDL需要花费几分钟到几个小时的停机时间，尤其是当表越来越大的时候。



##### 查询的数据局部性

文档通常以单个连续字符串的形式进行存储，编码为JSON、XML或BJSON。如果应用程序经常需要访问整个文档（例如，将其渲染到网页），那么存储局部性会带来性能优势。如果将数据分割到多个表中，则需要进行多次索引查找才能将其全部检索出来，这可能需要更多的磁盘查找并花费更多的时间。



局部性仅仅适用于同时需要文档绝大部分内容的情况，数据库通常需要加载整个文档，即使只访问其中的一小部份，这对于大型文档来说是很浪费的。更新文档时，通常需要整个重写。只有不改变文档大小的修改可以容易地原地执行。因此，通常建议保持相对小的文档，并避免增加文档大小的写入。



##### 文档和关系数据库的融合

关系型数据库大都已支持XML。

文档数据库也在逐渐支持连接。

他们的混合是一条很好的路线。



## 数据查询语言



SQL是一种声明式查询语言，而IMS和CODASYL使用命令式代码来查询数据库。

一些NoSQL数据存储（如MongoDB和CounchDB）支持有限形式的MapReduce，作为多个文档中执行只读查询的机制。



MapReduce既不是一个声明式的查询语言，也不是一个完全命令式的查询API，而是处于两者之间：查询的逻辑可以用代码片段来表示，这些代码片段会被处理框架重复性调用。它基于map和reduce函数。



## 图数据模型



多对多关系是不同数据模型之间 具有区别性的重要特征。如果你的程序大多数的关系是一对多关系（树状结构化数据），或者大多数记录之间不存在关系，那么使用文档模型是合适的。

关系模型可以处理多对多关系 的简单情况，但是随着数据之间的连接变得更加复杂，将数据建模为图形更合适。

图由两种关系组成：顶点和边（也称为关系）。

- 社交图谱
- 网络图谱
- 公路或铁路网络



汽车导航系统搜索道路网络中两点之间的最短路径，PageRank可以用在网络图上来确定网页的流行程度，从而确定该网页在搜索结果中的排名。



### 属性图

在属性图模型中，每个顶点（vertex）包括：

- 唯一的标识符
- 一组出边（outgoing edges）
- 一组入边（ingoing edges）
- 一组属性（键值对）

每条边（edge）包括：

- 唯一标识符
- 边的起点
- 边的终点
- 描述两个顶点之间关系类型的标签
- 一组属性（键值对）



可以将图存储看作两个关系表组成：一个存储顶点，另一个存储边。

```sql
CREATE TABLE vertices (
  vertex_id  INTEGER PRIMARY KEY,
  properties JSON
);

CREATE TABLE edges (
  edge_id     INTEGER PRIMARY KEY,
  tail_vertex INTEGER REFERENCES vertices (vertex_id),
  head_vertex INTEGER REFERENCES vertices (vertex_id),
  label       TEXT,
  properties  JSON
);

CREATE INDEX edges_tails ON edges (tail_vertex);
CREATE INDEX edges_heads ON edges (head_vertex);
```

1. 任何顶点都有一条边连接到任何其他顶点；
2. 给定任何顶点，可以高效地找到入边和出边，从而遍历图
3. 通过对不同的关系存储不同的标签，可以在一个图中存储几种不同的信息；


### Cypher查询语言

Cypher 是属性图的声明式查询语言，为 Neo4j 图形数据库而发明。
