#### 收敛一致

对于单主模型来说，如果同一条数据被写入多次，那么最终必定由最后一个写操作取得胜利。

但是在多主模型中，写入的顺序并不明确，因为在每一个客户端看来，自己的写入都是合法的。

可以参考的方法：

1. 每个写入分配ID，按照ID排序，容易造成数据丢失
2. 每个节点分配ID，按照节点优先级决定收敛优先级，意味着数据丢失
3. 都留下来，通过某种方法连接起来
4. 都保留下来，但是提供diff信息，让客户端解决

#### 自定义解决冲突逻辑

1. 写时执行：只要数据库系统检测到复制更改日志中存在冲突，就会调用冲突处理程序
2. 读时执行：写时将所有写入存储，读取时将多个版本的数据都返回客户端，有客户端决定如何解决（可以提供自动脚本），然后将解决的结果写回数据库

> 冲突解决通常适用于单行记录或单个文档的层面，而不是整个事务

##### 怎么自动解决冲突？

- **无冲突复制数据类型**(**Conflict-free replicated datatypes**)：

- **可合并的持久数据结构（Mergeable persistent data structures)**

- **操作转换（operational transformation**

#### 明确冲突的定义：

常规认知：对同一条数据的并发写入

奇奇怪怪的例子：似乎需要和具体的应用场景结合考虑

> 考虑一个会议室预定系统。预定同一个会议室不一定会发生冲突，只有预定时间段有交叠，才会有冲突。
