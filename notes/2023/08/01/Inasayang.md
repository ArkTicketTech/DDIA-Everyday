重审原子提交

幂等性

-   丢弃失败任务的部分输出，以便可以安全地重试，不会发生两次失效
-   如果操作不是具备幂等性，可以使用额外地元数据使其幂等性
    -   处理来自kafka的消息，每条消息包含一个持久的，单调递增的偏移量

故障后重建状态

-   状态保存到远称存储，采取复制，慢
-   状态保存在本地，定期复制
    -   Flink定期对操作状态执行快照，写入持久性存储
    -   VoltDB在多个节点上冗余处理输入消息来复制状态



Pp. 447-459