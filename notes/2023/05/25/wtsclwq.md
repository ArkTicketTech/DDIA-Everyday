#### 文档模型和Join的冲突

region 在存储时，为什么不直接存储纯字符串：“Greater Seattle Area”，而是先存为 region_id → region name，其他地方都引用 region_id？

主要是为了规范化：

1. **统一样式**：所有用到相同概念的地方都有相同的拼写和样式
2. **避免歧义**：可能有同名地区
3. **易于修改**：如果一个地区改名了，我们不用去逐一修改所有引用他的地方
4. **本地化支持**：如果翻译成其他语言，可以只翻译名字表。
5. **更好搜索**：列表可以关联地区，进行树形组织

类似regino和user,其实是多对一的关系，文档模型对于这种关系的表现力不够强。

关系型数据库能够使用Join操作，将user信息和regin信息组合成一个record,但是文档数据库对于join的支持性不够强，只能将这些复杂度转移到应用层。

|            | 文档型                                                       | 关系型                                      |
| :--------: | ------------------------------------------------------------ | ------------------------------------------- |
|  对应关系  | 数据有天然的一对多、树形嵌套关系，如简历。                   | 通过外键 + Join 可以处理 多对一，多对多关系 |
|  代码简化  | 数据具有文档结构，则文档模型天然合适，用关系模型会使得建模繁琐、访问复杂。但不宜嵌套太深，因为只能手动指定访问路径，或者范围遍历 | 主键，索引，条件过滤                        |
| Join 支持  | 对 Join 支持的不太好                                         | 支持的还可以，但 Join 的实现会有很多难点    |
| 模式灵活性 | 弱 schema，支持动态增加字段                                  | 强 schema，修改 schema 代价很大             |
| 访问局部性 | 1. 一次性访问整个文档，较优 2. 只访问文档一部分，较差        | 分散在多个表中                              |

> 对于高度关联的数据集，使用文档型表达比较奇怪，使用关系型可以接受，使用图模型最自然。

