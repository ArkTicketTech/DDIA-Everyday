实践中的分布式事务

-   两种不同的分布式事务
    -   数据库内部的分布式事务：同一个家厂商，同一个系统
    -   异构分布式事务：不同厂商，不同系统



Exactly-once消息处理



XA交易（`X/Open XA`（`eXtended Architecture XA`））

-   异构环境下实施两阶段提交的一个工业标准，不是网络协议，是与事务协调者通信的C API



停顿时仍持有锁

-   事务提交或中止之前，会一致持有锁（如果协调者一直崩溃）
-   数据加锁时，其他事务无法执行
-   协调者故障恢复
    -   自动解决
    -   人工解决
    -   启发式决策



分布式事务的限制

-   核心的事务协调者也是一种数据库（存储事务的投票结果）
-   协调者不应该是单节点
-   与各种数据系统保持兼容（兼容最低标准）



Pp. 337-341