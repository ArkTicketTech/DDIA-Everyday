针对频繁故障的设计

-   `MapReduce`和`MPP`数据库不同的是：如何处理故障与如何使用内存和磁盘
-   批处理对故障的敏感度较低，在线系统对故障的敏感度教高
    -   `MPP`遇到崩溃时，会中止查询，让用户进行重试或自动重试。一般会在几分钟之内，代价不大
    -   `MPP`更倾向于在内存中保留更多的数据，避免读取磁盘的成本
    -   `MapReduce`可以容忍`map`或`reduce`的失败，通过单个任务的粒度重试来避免影响整体作业
    -   `MapReduce`会将数据写入磁盘
        -   容错
        -   数据量大不能载入内存
    -   `MapReduce`更适用于大的作业：数据量大且运行时间长，运行中可能遇到多次故障



中间状态实体化

-   一个作业的输出用作另一个作业的输入，分布式文件系统上的文件只是中间状态
    -   这个中间状态写入文件的过程称为实体化（或物化）
    -   提前计算某些操作结果并将其写入磁盘，而不是在需要时才进行计算
-   完全实体化中间状态的不利
    -   必须等待前面作业所有任务的完成才能启动
    -   mapper通常是冗余的
    -   中间状态存储在分布式文件系统中意味着文件被复制多次，这只是临时数据而已



数据流引擎

-   把整个工作流作为一个作业来处理
-   优点
    -   排序等计算代价昂贵的任务只在实际需要时进行
    -   没有不必要的map任务



容错

-   将中间状态完全实体化到分布式文件系统的一个优点是持久化
-   流引擎避免将中间状态写入分布式文件系统，采用不同的方法
    -   利用其他可用的数据重新计算（...废话）
-   `Spart`使用弹性分布式数据集（`Resilient Distributed Dataset,RDD`）来追踪数据的祖先
-   `Flink`对运算符建立检查点，允许将遇到故障的运算符恢复运行



Pp. 392-397