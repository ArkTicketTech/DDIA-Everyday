map端join操作

-   reduce端join
    -   mapper负责准备输入数据：从每个输入记录中提取关键字和值，将键值对分配给reducer分区，并按关键字分区
        -   排序，复制到reducer以及合并reducer输入是昂贵的操作，取决于内存缓冲区
-   map端join
    -   没有reducer，没有排序
    -   每个mapper从分布式系统读取文件块，输出文件




广播哈希join

-   map端join适合大数据集与小数据集join，小数据集能全部加载到内存中
-   广播哈希join
    -   大数据集的每个文件块对应一个mapper，每个mapper还负责将小数据集全部加载到内存中
    -   广播：大数据集每个分区的mapper还读取整个小数据集（小数据集被“广播”给大数据集）
    -   哈希：使用哈希表
-   另一种方法
    -   小数据集保存在本地磁盘的只读索引上
    -   由于频繁访问，索引大部分内容都驻留在页面缓存上，所以与内存哈希表有几乎一样快的随机访问性能
    -   ？那为什么不用这个？





批处理工作流的输出

-   批处理与分析更为接近，因为批处理通常会扫描大部分的输入数据集
-   MapReduce作业的工作流与分析中的SQL查询不同，批处理过程输出通常不是报告，而是其他类型的数据结构



生成搜索索引

-   对一组固定文档进行全文检索，批处理是构建索引的有效方法
    -   mapper对文档集进行分区
    -   reducer构建其分区索引，将索引文件写入分布式文件系统
-   按关键字查询搜索索引是只读操作，索引文件一旦创建不可变
-   如果索引文档集合发生改变，则可以定期重新选择整个索引工作流，再用新的索引文件替换旧索引文件
-   如果只是少量文档变化了，则计算可能比较昂贵
-   增量建立索引
    -   生成新的段文件，后台异步合并并压缩段文件



Pp. 384-